--- a/Makefile.orig	2019-08-06 13:48:31.516596275 +0100
+++ b/Makefile	2019-08-06 15:31:06.187597814 +0100
@@ -197,6 +197,13 @@
 KDE_PREFIX:=$(shell kde-config --install xdgdata-apps --expandvars 2> /dev/null)
 KDE_ICON_PREFIX:=$(shell kde4-config --install icon --expandvars 2> /dev/null)
 
+ifneq ($(KDE_ICON_PREFIX),)
+  XDG_ICON_PREFIX:=$(KDE_ICON_PREFIX)
+else
+  XDG_ICON_PREFIX:=$(DESTDIR)$(PREFIX)/share/icons
+endif
+
+
 # Maemo flag
 MAEMOFLAG:=
 
@@ -467,7 +474,7 @@
 windows_ARCH_INSTALL:=
 osx_ARCH_INSTALL:=install-macbundle TuxPaint.dmg
 beos_ARCH_INSTALL:=install-haiku
-linux_ARCH_INSTALL:=install-kde install-kde-icons
+linux_ARCH_INSTALL:=install-kde install-xdg-icons
 ARCH_INSTALL:=$($(OS)_ARCH_INSTALL)
 
 # "make install" installs all of the various parts
@@ -614,17 +621,15 @@
 	fi
 	-rm $(ICON_PREFIX)/tuxpaint.png
 	-rm $(X11_ICON_PREFIX)/tuxpaint.xpm
-	-if [ "x$(KDE_ICON_PREFIX)" != "x" ]; then \
-	  rm $(KDE_ICON_PREFIX)/hicolor/scalable/apps/tuxpaint.svg; \
-	  rm $(KDE_ICON_PREFIX)/hicolor/192x192/apps/tuxpaint.png; \
-	  rm $(KDE_ICON_PREFIX)/hicolor/128x128/apps/tuxpaint.png; \
-	  rm $(KDE_ICON_PREFIX)/hicolor/96x96/apps/tuxpaint.png; \
-	  rm $(KDE_ICON_PREFIX)/hicolor/64x64/apps/tuxpaint.png; \
-	  rm $(KDE_ICON_PREFIX)/hicolor/48x48/apps/tuxpaint.png; \
-	  rm $(KDE_ICON_PREFIX)/hicolor/32x32/apps/tuxpaint.png; \
-	  rm $(KDE_ICON_PREFIX)/hicolor/22x22/apps/tuxpaint.png; \
-	  rm $(KDE_ICON_PREFIX)/hicolor/16x16/apps/tuxpaint.png; \
-	fi
+	-rm $(XDG_ICON_PREFIX)/hicolor/scalable/apps/tuxpaint.svg; \
+	-rm $(XDG_ICON_PREFIX)/hicolor/192x192/apps/tuxpaint.png; \
+	-rm $(XDG_ICON_PREFIX)/hicolor/128x128/apps/tuxpaint.png; \
+	-rm $(XDG_ICON_PREFIX)/hicolor/96x96/apps/tuxpaint.png; \
+	-rm $(XDG_ICON_PREFIX)/hicolor/64x64/apps/tuxpaint.png; \
+	-rm $(XDG_ICON_PREFIX)/hicolor/48x48/apps/tuxpaint.png; \
+	-rm $(XDG_ICON_PREFIX)/hicolor/32x32/apps/tuxpaint.png; \
+	-rm $(XDG_ICON_PREFIX)/hicolor/22x22/apps/tuxpaint.png; \
+	-rm $(XDG_ICON_PREFIX)/hicolor/16x16/apps/tuxpaint.png; \
 	-rm $(BIN_PREFIX)/tuxpaint
 	-rm $(BIN_PREFIX)/tuxpaint-import
 	-rm -r $(DATA_PREFIX)
@@ -784,55 +789,58 @@
 .PHONY: install-kde
 install-kde:
 	@echo
-	@echo "...Installing launcher icon into KDE..."
 	@if [ "x$(KDE_PREFIX)" != "x" ]; then \
+	  echo "...Installing launcher icon into KDE..."; \
 	  install -d $(DESTDIR)$(KDE_PREFIX); \
 	  cp src/tuxpaint.desktop $(DESTDIR)$(KDE_PREFIX)/; \
 	  chmod 644 $(DESTDIR)$(KDE_PREFIX)/tuxpaint.desktop; \
+	  kbuildsycoca4; \
+	else \
+	  echo "...Installing launcher into XDG..."; \
+	  install -d $(DESTDIR)$(PREFIX)/share/applications; \
+	  cp src/tuxpaint.desktop $(DESTDIR)$(PREFIX)/share/applications/; \
+	  chmod 644 $(DESTDIR)$(PREFIX)/share/applications/tuxpaint.desktop; \
 	fi
-	kbuildsycoca4
 
-.PHONY: install-kde-icons
-install-kde-icons:
-	@echo "...Installing launcher icon graphics into KDE..."
-	@if [ "x$(KDE_ICON_PREFIX)" != "x" ]; then \
-	  install -d $(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/scalable/apps/; \
-	  install -d $(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/192x192/apps/; \
-	  install -d $(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/128x128/apps/; \
-	  install -d $(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/96x96/apps/; \
-	  install -d $(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/64x64/apps/; \
-	  install -d $(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/48x48/apps/; \
-	  install -d $(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/32x32/apps/; \
-	  install -d $(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/22x22/apps/; \
-	  install -d $(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/16x16/apps/; \
-	  cp data/images/tuxpaint-icon.svg \
-		$(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/scalable/apps/tuxpaint.svg; \
-          chmod 644 $(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/scalable/apps/tuxpaint.svg; \
-	  cp data/images/icon192x192.png \
-		$(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/192x192/apps/tuxpaint.png; \
-          chmod 644 $(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/192x192/apps/tuxpaint.png; \
-	  cp data/images/icon128x128.png \
-		$(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/128x128/apps/tuxpaint.png; \
-          chmod 644 $(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/128x128/apps/tuxpaint.png; \
-	  cp data/images/icon96x96.png \
-		$(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/96x96/apps/tuxpaint.png; \
-          chmod 644 $(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/96x96/apps/tuxpaint.png; \
-	  cp data/images/icon64x64.png \
-		$(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/64x64/apps/tuxpaint.png; \
-          chmod 644 $(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/64x64/apps/tuxpaint.png; \
-	  cp data/images/icon48x48.png \
-		$(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/48x48/apps/tuxpaint.png; \
-          chmod 644 $(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/48x48/apps/tuxpaint.png; \
-	  cp data/images/icon32x32.png \
-		$(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/32x32/apps/tuxpaint.png; \
-          chmod 644 $(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/32x32/apps/tuxpaint.png; \
-	  cp data/images/icon22x22.png \
-		$(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/22x22/apps/tuxpaint.png; \
-          chmod 644 $(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/22x22/apps/tuxpaint.png; \
-	  cp data/images/icon16x16.png \
-		$(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/16x16/apps/tuxpaint.png; \
-          chmod 644 $(DESTDIR)$(KDE_ICON_PREFIX)/hicolor/16x16/apps/tuxpaint.png; \
-	fi
+.PHONY: install-xdg-icons
+install-xdg-icons:
+	@echo "...Installing launcher icon graphics into XDG..."
+	install -d $(XDG_ICON_PREFIX)/hicolor/scalable/apps/; \
+	install -d $(XDG_ICON_PREFIX)/hicolor/192x192/apps/; \
+	install -d $(XDG_ICON_PREFIX)/hicolor/128x128/apps/; \
+	install -d $(XDG_ICON_PREFIX)/hicolor/96x96/apps/; \
+	install -d $(XDG_ICON_PREFIX)/hicolor/64x64/apps/; \
+	install -d $(XDG_ICON_PREFIX)/hicolor/48x48/apps/; \
+	install -d $(XDG_ICON_PREFIX)/hicolor/32x32/apps/; \
+	install -d $(XDG_ICON_PREFIX)/hicolor/22x22/apps/; \
+	install -d $(XDG_ICON_PREFIX)/hicolor/16x16/apps/; \
+	cp data/images/tuxpaint-icon.svg \
+		$(XDG_ICON_PREFIX)/hicolor/scalable/apps/tuxpaint.svg; \
+        chmod 644 $(XDG_ICON_PREFIX)/hicolor/scalable/apps/tuxpaint.svg; \
+	cp data/images/icon192x192.png \
+		$(XDG_ICON_PREFIX)/hicolor/192x192/apps/tuxpaint.png; \
+        chmod 644 $(XDG_ICON_PREFIX)/hicolor/192x192/apps/tuxpaint.png; \
+	cp data/images/icon128x128.png \
+		$(XDG_ICON_PREFIX)/hicolor/128x128/apps/tuxpaint.png; \
+        chmod 644 $(XDG_ICON_PREFIX)/hicolor/128x128/apps/tuxpaint.png; \
+	cp data/images/icon96x96.png \
+		$(XDG_ICON_PREFIX)/hicolor/96x96/apps/tuxpaint.png; \
+        chmod 644 $(XDG_ICON_PREFIX)/hicolor/96x96/apps/tuxpaint.png; \
+	cp data/images/icon64x64.png \
+		$(XDG_ICON_PREFIX)/hicolor/64x64/apps/tuxpaint.png; \
+        chmod 644 $(XDG_ICON_PREFIX)/hicolor/64x64/apps/tuxpaint.png; \
+	cp data/images/icon48x48.png \
+		$(XDG_ICON_PREFIX)/hicolor/48x48/apps/tuxpaint.png; \
+        chmod 644 $(XDG_ICON_PREFIX)/hicolor/48x48/apps/tuxpaint.png; \
+	cp data/images/icon32x32.png \
+		$(XDG_ICON_PREFIX)/hicolor/32x32/apps/tuxpaint.png; \
+        chmod 644 $(XDG_ICON_PREFIX)/hicolor/32x32/apps/tuxpaint.png; \
+	cp data/images/icon22x22.png \
+		$(XDG_ICON_PREFIX)/hicolor/22x22/apps/tuxpaint.png; \
+        chmod 644 $(XDG_ICON_PREFIX)/hicolor/22x22/apps/tuxpaint.png; \
+	cp data/images/icon16x16.png \
+		$(XDG_ICON_PREFIX)/hicolor/16x16/apps/tuxpaint.png; \
+        chmod 644 $(XDG_ICON_PREFIX)/hicolor/16x16/apps/tuxpaint.png; \
 
 
 # Install the PNG icon (for KDE desktop, etc.)
